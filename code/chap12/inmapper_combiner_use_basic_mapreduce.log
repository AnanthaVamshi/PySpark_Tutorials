$ cat sample_dna_seq.txt
ATCGGGATCCGGG
ATTCCGGGATTCCCC
ATGGCCCCCGGGATCGGG
CGGTATCCGGGGAAAAA
aaattCCGGAACCGGGGGTTT
CCTTTTATCGGGCAAATTTTCCCGG
attttcccccggaaaAAATTTCCGGG
ACTGACTAGCTAGCTAACTG
GCATCGTAGCTAGCTACGAT
AATTCCCGCATCGATCGTACGTACGTAG
ATCGATCGATCGTACGATCG

# define PySpark program
export PROG="/pyspark_book/code/chap12/inmapper_combiner_use_basic_mapreduce.py"
# define your input path
export INPUT="/pyspark_book/code/chap12/sample_dna_seq.txt"
# define your Spark home directory
export SPARK_HOME="/pyspark_book/spark-2.4.3"
# run the program
$SPARK_HOME/bin/spark-submit $PROG $INPUT
input_path: /pyspark_book/code/chap12/sample_dna_seq.txt

records.count():  11

input_path: sample_dna_seq.txt
records.count():  11
records.collect():  
[
 u'ATCGGGATCCGGG', 
 u'ATTCCGGGATTCCCC', 
 u'ATGGCCCCCGGGATCGGG', 
 u'CGGTATCCGGGGAAAAA', 
 u'aaattCCGGAACCGGGGGTTT', 
 u'CCTTTTATCGGGCAAATTTTCCCGG', 
 u'attttcccccggaaaAAATTTCCGGG', 
 u'ACTGACTAGCTAGCTAACTG', 
 u'GCATCGTAGCTAGCTACGAT', 
 u'AATTCCCGCATCGATCGTACGTACGTAG', 
 u'ATCGATCGATCGTACGATCG'
]

records.getNumPartitions():  2

pairs.count():  223

pairs.collect():  [(u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'A', 1), (u'T', 1), (u'G', 1), (u'G', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'T', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'A', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'C', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'G', 1), (u'G', 1), (u'A', 1), (u'C', 1), (u'T', 1), (u'G', 1), (u'A', 1), (u'C', 1), (u'T', 1), (u'A', 1), (u'G', 1), (u'C', 1), (u'T', 1), (u'A', 1), (u'G', 1), (u'C', 1), (u'T', 1), (u'A', 1), (u'A', 1), (u'C', 1), (u'T', 1), (u'G', 1), (u'G', 1), (u'C', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'T', 1), (u'A', 1), (u'G', 1), (u'C', 1), (u'T', 1), (u'A', 1), (u'G', 1), (u'C', 1), (u'T', 1), (u'A', 1), (u'C', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'A', 1), (u'A', 1), (u'T', 1), (u'T', 1), (u'C', 1), (u'C', 1), (u'C', 1), (u'G', 1), (u'C', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'T', 1), (u'A', 1), (u'C', 1), (u'G', 1), (u'T', 1), (u'A', 1), (u'C', 1), (u'G', 1), (u'T', 1), (u'A', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1), (u'T', 1), (u'A', 1), (u'C', 1), (u'G', 1), (u'A', 1), (u'T', 1), (u'C', 1), (u'G', 1)]

frequencies.count():  4
frequencies.collect():  
[
 (u'A', 51), 
 (u'C', 59), 
 (u'G', 60), 
 (u'T', 53)
]